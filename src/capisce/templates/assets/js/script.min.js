async function sendRequest(){let e=$("#method-button").text(),t=$("#endpoint").val();if(!t)return void $("#endpoint").focus();$("#progressBar").removeClass("visually-hidden");let r={},s={},n={},o=$("#params-table").find(".table-row");for(row of o)r[$(row).find(".table-key").val()]=$(row).find(".table-value").val();let a=$("#headers-table").find(".table-row");for(row of a)s[$(row).find(".table-key").val()]=$(row).find(".table-value").val();let d=$("#body-table").find(".table-row");for(row of d)n[$(row).find(".table-key").val()]=$(row).find(".table-value").val();let i=[t,r,s,n];if(sessionStorage.setItem("request-"+r_index,JSON.stringify(i)),showRequestContent(e,i),"GET"==e){let n=await makeGetRequest(t,r,s);sessionStorage.setItem("response-"+r_index,JSON.stringify(n)),showResponseContent(e,n),$("#request-menu").attr("r_index",r_index);let o=$("#requests-examples").find(".get-request").clone();return o.attr("r_index",r_index),o.attr("r_method",e),o.find(".request-title").text(t),$("#requests-history").prepend(o),$("#current-request").empty(),$("#current-request").append(o.clone()),void(r_index+=1)}if("HEAD"==e){let n=await makeHeadRequest(t,r,s);sessionStorage.setItem("response-"+r_index,JSON.stringify(n)),showResponseContent(e,n),$("#request-menu").attr("r_index",r_index);let o=$("#requests-examples").find(".head-request").clone();return o.attr("r_index",r_index),o.attr("r_method",e),o.find(".request-title").text(t),$("#requests-history").prepend(o),$("#current-request").empty(),$("#current-request").append(o.clone()),void(r_index+=1)}if("POST"==e){let o=await makePostRequest(t,r,s,n);sessionStorage.setItem("response-"+r_index,JSON.stringify(o)),showResponseContent(e,o),$("#request-menu").attr("r_index",r_index);let a=$("#requests-examples").find(".post-request").clone();return a.attr("r_index",r_index),a.attr("r_method",e),a.find(".request-title").text(t),$("#requests-history").prepend(a),$("#current-request").empty(),$("#current-request").append(a.clone()),void(r_index+=1)}if("PUT"==e){let o=await makePutRequest(t,r,s,n);sessionStorage.setItem("response-"+r_index,JSON.stringify(o)),showResponseContent(e,o),$("#request-menu").attr("r_index",r_index);let a=$("#requests-examples").find(".put-request").clone();return a.attr("r_index",r_index),a.attr("r_method",e),a.find(".request-title").text(t),$("#requests-history").prepend(a),$("#current-request").empty(),$("#current-request").append(a.clone()),void(r_index+=1)}if("DELETE"==e){let o=await makeDeleteRequest(t,r,s,n);sessionStorage.setItem("response-"+r_index,JSON.stringify(o)),showResponseContent(e,o),$("#request-menu").attr("r_index",r_index);let a=$("#requests-examples").find(".delete-request").clone();return a.attr("r_index",r_index),a.attr("r_method",e),a.find(".request-title").text(t),$("#requests-history").prepend(a),$("#current-request").empty(),$("#current-request").append(a.clone()),void(r_index+=1)}if("OPTIONS"==e){let n=await makeOptionsRequest(t,r,s);sessionStorage.setItem("response-"+r_index,JSON.stringify(n)),showResponseContent(e,n),$("#request-menu").attr("r_index",r_index);let o=$("#requests-examples").find(".options-request").clone();return o.attr("r_index",r_index),o.attr("r_method",e),o.find(".request-title").text(t),$("#requests-history").prepend(o),$("#current-request").empty(),$("#current-request").append(o.clone()),void(r_index+=1)}if("PATCH"==e){let n=await makePatchRequest(t,r,s);sessionStorage.setItem("response-"+r_index,JSON.stringify(n)),showResponseContent(e,n),$("#request-menu").attr("r_index",r_index);let o=$("#requests-examples").find(".patch-request").clone();return o.attr("r_index",r_index),o.attr("r_method",e),o.find(".request-title").text(t),$("#requests-history").prepend(o),$("#current-request").empty(),$("#current-request").append(o.clone()),void(r_index+=1)}}async function download_content(){let e,t=$("#request-menu").attr("r_index"),r=JSON.parse(sessionStorage.getItem("response-"+t)),s=$("#download-link");if(r.hasOwnProperty("error")){e=r;let t="data:text/json;charset=utf-8,"+encodeURIComponent(e);return s.attr("download","response.json"),s.attr("href",t),void document.getElementById("download-link").click()}e=r.body;let n=r.content_type.match(mime_regex);if(!n)return void console.log("Content-Type unknown.");let o=n[0];if(!mime_db.hasOwnProperty(o))return void console.log("MIME type not in the database.");let a=mime_db[o];if(!a.hasOwnProperty("extensions"))return void console.log("MIME type has no extensions.");let d="."+a.extensions[0],i=`data:${a};base64,${e}`;s.attr("download","response"+d),s.attr("href",i),document.getElementById("download-link").click()}async function showResponseContent(e,t){if(t.hasOwnProperty("error")){let e=`<strong class="fs-6 text-danger">Error:</strong> ${t.error}`;return void $("#response-content").html(e)}let r=t.content_type,s=t.status_code,n=JSON.stringify(t.headers,null,4);$("#progressBar").addClass("visually-hidden");let o=r.match(mime_regex);if(!o){let e=`<strong class="fs-6 text-danger">Status:</strong> ${s}<br><br><strong class="fs-6 text-danger">Content Type:</strong> ${r}<br><br><strong class="fs-6 text-danger">Headers:</strong> ${n}<br><br>Content-Type is unknown, you have to download the file to view its content.`;return void $("#response-content").html(e)}let a=o[0];if(!mime_db.hasOwnProperty(a)){let e=`<strong class="fs-6 text-danger">Status:</strong> ${s}<br><br><strong class="fs-6 text-danger">Content Type:</strong> ${r}<br><br><strong class="fs-6 text-danger">Headers:</strong> ${n}<br><br>MIME-Type is unknown, you have to download the file to view its content.`;return void $("#response-content").html(e)}if("HEAD"==e){let e=`<strong class="fs-6 text-danger">Status:</strong> ${s}<br><br><strong class="fs-6 text-danger">Content Type:</strong> ${r}<br><br><strong class="fs-6 text-danger">Headers:</strong> ${n}`;return void $("#response-content").html(e)}let d=t.body;if("text/html"==a){let e=`Status: ${s}\n\nContent Type: ${r}\n\nHeaders: ${n}\n\nBody:\n${html_beautify(atob(d))}`;return void $("#response-content").text(e)}if("text/css"==a){let e=`<strong class="fs-6 text-danger">Status:</strong> ${s}<br><br><strong class="fs-6 text-danger">Content Type:</strong> ${r}<br><br><strong class="fs-6 text-danger">Headers:</strong> ${n}<br><br><strong class="fs-6 text-danger">Body:</strong><br>${css_beautify(atob(d))}`;return void $("#response-content").html(e)}if("application/octet-stream"==a){let e=`<strong class="fs-6 text-danger">Status:</strong> ${s}<br><br><strong class="fs-6 text-danger">Content Type:</strong> ${r}<br><br><strong class="fs-6 text-danger">Headers:</strong> ${n}<br><br>It doesn't make much sense to show binary data here, you have to download the file to view its content.`;return void $("#response-content").html(e)}if("application/json"==a){let e=`<strong class="fs-6 text-danger">Status:</strong> ${s}<br><br><strong class="fs-6 text-danger">Content Type:</strong> ${r}<br><br><strong class="fs-6 text-danger">Headers:</strong> ${n}<br><br><strong class="fs-6 text-danger">Body:</strong><br>${js_beautify(atob(d))}`;return void $("#response-content").html(e)}if("application/xml"==a){let e=`<strong class="fs-6 text-danger">Status:</strong> ${s}<br><br><strong class="fs-6 text-danger">Content Type:</strong> ${r}<br><br><strong class="fs-6 text-danger">Headers:</strong> ${n}<br><br><strong class="fs-6 text-danger">Body:</strong><br>${html_beautify(atob(d))}`;return void $("#response-content").html(e)}if(a.startsWith("image/")){let e=`<strong class="fs-6 text-danger">Status:</strong> ${s}<br><br><strong class="fs-6 text-danger">Content Type:</strong> ${r}<br><br><strong class="fs-6 text-danger">Headers:</strong> ${n}<br><br><strong class="fs-6 text-danger">Image:</strong><br><img class="img-fluid" src="data:${a};base64,${d}"></img>`;return void $("#response-content").html(e)}if(a.startsWith("video/")){let e=`<strong class="fs-6 text-danger">Status:</strong> ${s}<br><br><strong class="fs-6 text-danger">Content Type:</strong> ${r}<br><br><strong class="fs-6 text-danger">Headers:</strong> ${n}<br><br><strong class="fs-6 text-danger">Video:</strong><br><video class="img-fluid" src="data:${a};base64,${d}" controls></video>`;return void $("#response-content").html(e)}if(a.startsWith("audio/")){let e=`<strong class="fs-6 text-danger">Status:</strong> ${s}<br><br><strong class="fs-6 text-danger">Content Type:</strong> ${r}<br><br><strong class="fs-6 text-danger">Headers:</strong> ${n}<br><br><strong class="fs-6 text-danger">Audio:</strong><br><audio class="img-fluid" src="data:${a};base64,${d}"></audio>`;return void $("#response-content").html(e)}if(a.startsWith("text/")){let e=`<strong class="fs-6 text-danger">Status:</strong> ${s}<br><br><strong class="fs-6 text-danger">Content Type:</strong> ${r}<br><br><strong class="fs-6 text-danger">Headers:</strong> ${n}<br><br><strong class="fs-6 text-danger">Body:</strong><br>${atob(d)}`;return void $("#response-content").html(e)}let i=`<strong class="fs-6 text-danger">Status:</strong> ${s}<br><br><strong class="fs-6 text-danger">Content Type:</strong> ${r}<br><br><strong class="fs-6 text-danger">Headers:</strong> ${n}<br><br>Can't show the contents of the body here, you have to donwload it.`;$("#response-content").html(i)}async function showRequestContent(e,t){var r=construct_url(t[0],t[1]),s="";for(key of Object.keys(t[2]))s+=`&nbsp;&nbsp;&nbsp;&nbsp;${key}&nbsp;:&nbsp;${t[2][key]}<br>`;var n="";for(key of Object.keys(t[3]))n+=`&nbsp;&nbsp;&nbsp;&nbsp;${key}&nbsp;:&nbsp;${t[2][key]}<br>`;switch(e){case"GET":var o=`<strong class="fs-6 text-danger">URL:</strong> ${r}<br><strong class="fs-6 text-danger">HEADERS:</strong><br>${s}`;break;case"HEAD":o=`<strong class="fs-6 text-danger">URL:</strong> ${r}<br><strong class="fs-6 text-danger">HEADERS:</strong><br>${s}`;break;case"POST":o=`<strong class="fs-6 text-danger">URL:</strong> ${r}<br><strong class="fs-6 text-danger">HEADERS:</strong><br>${s}<br><strong class="fs-6 text-danger">BODY:</strong><br>${n}`;break;case"PUT":o=`<strong class="fs-6 text-danger">URL:</strong> ${r}<br><strong class="fs-6 text-danger">HEADERS:</strong><br>${s}<br><strong class="fs-6 text-danger">BODY:</strong><br>${n}`;break;case"DELETE":o=`<strong class="fs-6 text-danger">URL:</strong> ${r}<br><strong class="fs-6 text-danger">HEADERS:</strong><br>${s}<br><strong class="fs-6 text-danger">BODY:</strong><br>${n}`;break;case"OPTIONS":o=`<strong class="fs-6 text-danger">URL:</strong> ${r}<br><strong class="fs-6 text-danger">HEADERS:</strong><br>${s}`;break;case"PATCH":o=`<strong class="fs-6 text-danger">URL:</strong> ${r}<br><strong class="fs-6 text-danger">HEADERS:</strong><br>${s}<br><strong class="fs-6 text-danger">BODY:</strong><br>${n}`}$("#request-content").html(o)}const r=document.querySelector(":root");async function changeBackground(e){let t=$(e).attr("theme");return"light"==t?(r.style.setProperty("--background-color","var(--background-color-night)"),r.style.setProperty("--card-background","var(--card-background-night)"),r.style.setProperty("--text-general","var(--text-night)"),$(e).removeClass("bi-lamp-fill").addClass("bi-lamp"),void $(e).attr("theme","night")):"night"==t?(r.style.setProperty("--background-color","var(--background-color-light)"),r.style.setProperty("--card-background","var(--card-background-light"),r.style.setProperty("--text-general","var(--text-light)"),$(e).removeClass("bi-lamp").addClass("bi-lamp-fill"),void $(e).attr("theme","light")):void 0}const req_server="http://127.0.0.1:5000",mime_regex=/(\S+\/[^;]+)/,setup_row=$(".table-unrow").first().clone();var r_index=0,mime_db=null;async function loadHistoricRequest(e){let t=$(e).attr("r_index"),r=$(e).attr("r_method"),s=JSON.parse(sessionStorage.getItem("request-"+t)),n=JSON.parse(sessionStorage.getItem("response-"+t));showRequestContent(r,s),showResponseContent(r,n),$("#current-request").empty(),$("#current-request").append($(e).clone())}function check_row(e){return $(e).hasClass("btn-primary")?($(e).removeClass("btn-primary").addClass("btn-danger"),void $(e).closest(".table-row").removeClass("table-row").addClass("table-unrow")):$(e).hasClass("btn-danger")?($(e).removeClass("btn-danger").addClass("btn-primary"),void $(e).closest(".table-unrow").removeClass("table-unrow").addClass("table-row")):void 0}function delete_row(e){$(e).closest(".table-row").remove()}function setup(e){var t=$(e).closest(".table-unrow");t.removeClass("table-unrow").addClass("table-row");let r=$("#helper-elements").find(".checkbox-item").clone(),s=$("#helper-elements").find(".delete-item").clone();$(e).closest("tbody").append(setup_row.clone()),t.find(".table-key").parent().prepend(r),t.find(".table-value").parent().append(s),t.find(".table-key").prop("onchange",null),t.find(".table-value").prop("onchange",null)}function loadMimeDB(){return $.getJSON("assets/json/db.json").then((e=>e))}function downloadMimeDB(){return $.getJSON("https://cdn.jsdelivr.net/npm/mime-db@1/db.json").then((e=>e))}function construct_url(e,t){if(Object.keys(t).length){let r=new URL(e),s=new URLSearchParams(r.search);for(key of Object.keys(t))s.append(key,t[key]);e=new URL(`${r.origin}${r.pathname}?${s}`).href}return e}function makeGetRequest(e,t,r){return e=construct_url(e,t),fetch(req_server+"/get",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({endpoint:e,headers:r})}).then((e=>e.json()))}function makeHeadRequest(e,t,r){return e=construct_url(e,t),fetch(req_server+"/head",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({endpoint:e,headers:r})}).then((e=>e.json()))}function makePostRequest(e,t,r,s){return e=construct_url(e,t),fetch(req_server+"/post",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({endpoint:e,headers:r,body:s})}).then((e=>e.json()))}function makePutRequest(e,t,r,s){return e=construct_url(e,t),fetch(req_server+"/put",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({endpoint:e,headers:r,body:s})}).then((e=>e.json()))}function makeDeleteRequest(e,t,r,s){return e=construct_url(e,t),fetch(req_server+"/delete",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({endpoint:e,headers:r,body:s})}).then((e=>e.json()))}function makeOptionsRequest(e,t,r){return e=construct_url(e,t),fetch(req_server+"/options",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({endpoint:e,headers:r})}).then((e=>e.json()))}function makePatchRequest(e,t,r,s){return e=construct_url(e,t),fetch(req_server+"/patch",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({endpoint:e,headers:r,body:s})}).then((e=>e.json()))}async function copy_content(e){let t,r=$("#request-menu").attr("r_index");if("response"===e){var s=JSON.parse(sessionStorage.getItem("response-"+r));if(s.hasOwnProperty("error"))return t=s,void navigator.clipboard.writeText(t).then((e=>{console.log("Copied.")}));t=atob(s.body),navigator.clipboard.writeText(t).then((e=>{console.log("Copied.")}))}}$(window).on("load",(async function(){sessionStorage.clear();try{mime_db=await loadMimeDB()}catch(e){mime_db=await downloadMimeDB()}console.assert(null!=mime_db,"mime-db not loaded correctly.");[...document.querySelectorAll('[data-bs-toggle="popover"]')].map((e=>new bootstrap.Popover(e,{customClass:"copyPopover"})))})),$(".method").on("click",(function(){$("#method-button").text(this.text)})),$("#endpoint").on("keyup",(function(e){"Enter"==e.key&&sendRequest()})),$("#send-button").on("click",sendRequest);