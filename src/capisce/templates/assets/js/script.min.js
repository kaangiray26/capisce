async function load_content(e){if(e.hasOwnProperty("error")){let t=`Error: ${e.error}`;return void $("#response-content").html(t)}let t=e.body,n=e.status_code,o=e.content_type,r=e.content_type.match(mime_regex);if(!r)return void console.log("Content-Type unknown.");let s=r[0];if($("#progressBar").addClass("visually-hidden"),"application/octet-stream"==s){let e=`Status: ${n}<br>Content Type: ${o}<br><br>Can't show the contents of the body here, you have to donwload it.`;return void $("#response-content").html(e)}if("application/json"==s){let e=`Status: ${n}\nContent Type: ${o}\n\nBody:\n${js_beautify(atob(t))}`;return void $("#response-content").text(e)}if("text/html"==s){let e=`Status: ${n}\nContent Type: ${o}\n\nBody:\n${html_beautify(atob(t))}`;return void $("#response-content").text(e)}if("text/css"==s){let e=`Status: ${n}\nContent Type: ${o}\n\nBody:\n${css_beautify(atob(t))}`;return void $("#response-content").text(e)}if("application/xml"==s){let e=`Status: ${n}\nContent Type: ${o}\n\nBody:\n${html_beautify(atob(t))}`;return void $("#response-content").text(e)}if(s.startsWith("image/")){let e=`Status: ${n}<br>Content Type: ${o}<br><br>Image:<br><img class="img-fluid" src="data:${s};base64,${t}"></img>`;return void $("#response-content").html(e)}if(s.startsWith("video/")){let e=`Status: ${n}<br>Content Type: ${o}<br><br>Video:<br><video src="data:${s};base64,${t}" controls></video>`;return void $("#response-content").html(e)}if(s.startsWith("audio/")){let e=`Status: ${n}<br>Content Type: ${o}<br><br>Audio:<br><audio src="data:${s};base64,${t}" controls></audio>`;return void $("#response-content").html(e)}if(s.startsWith("text/")){let e=`Status: ${n}\nContent Type: ${o}\n\nBody:\n${atob(t)}`;return void $("#response-content").text(e)}let a=`Status: ${n}<br>Content Type: ${o}<br><br>Can't show the contents of the body here, you have to donwload it.`;$("#response-content").html(a)}async function download_content(e){let t,n=$(e).attr("r_index"),o=JSON.parse(sessionStorage.getItem("response-"+n)),r=$("#download-link");if(o.hasOwnProperty("error")){t=o;let e="data:text/json;charset=utf-8,"+encodeURIComponent(t);return r.attr("download","response.json"),r.attr("href",e),void document.getElementById("download-link").click()}t=o.body;let s=o.content_type.match(mime_regex);if(!s)return void console.log("Content-Type unknown.");let a=s[0];if(!mime_db.hasOwnProperty(a))return void console.log("MIME type not in the database.");let i=mime_db[a];if(!i.hasOwnProperty("extensions"))return void console.log("MIME type has no extensions.");let l="."+i.extensions[0],d=`data:${i};base64,${t}`;r.attr("download","response"+l),r.attr("href",d),document.getElementById("download-link").click()}const req_server="http://127.0.0.1:5000",mime_regex=/(\S+\/[^;]+)/,setup_row=$(".table-unrow").first().clone();var r_index=0,mime_db=null;async function showRequestContent(e){var t=construct_url(e[0],e[1]),n="";for(key of Object.keys(e[2]))n+=`&nbsp;&nbsp;&nbsp;&nbsp;${key}&nbsp;:&nbsp;${e[2][key]}<br>`;var o="";for(key of Object.keys(e[3]))o+=`&nbsp;&nbsp;&nbsp;&nbsp;${key}&nbsp;:&nbsp;${e[2][key]}<br>`;var r=`URL: ${t}<br>HEADERS:<br>${n}BODY:<br>${o}`;$("#request-content").html(r)}async function sendRequest(){var e=$("#method-button").text(),t=$("#endpoint").val();if(!t)return void $("#endpoint").focus();$("#progressBar").removeClass("visually-hidden");var n={},o={},r={},s=$("#params-table").find(".table-row");for(row of s)n[$(row).find(".table-key").val()]=$(row).find(".table-value").val();var a=$("#headers-table").find(".table-row");for(row of a)o[$(row).find(".table-key").val()]=$(row).find(".table-value").val();var i=$("#body-table").find(".table-row");for(row of i)r[$(row).find(".table-key").val()]=$(row).find(".table-value").val();let l=[t,n,o,r];if(sessionStorage.setItem("request-"+r_index,JSON.stringify(l)),showRequestContent(l),"GET"==e){var d=await makeGetRequest(t,n,o);sessionStorage.setItem("response-"+r_index,JSON.stringify(d)),load_content(d),$("#download-response-button").attr("r_index",r_index);let e=$("#requests-examples").find(".get-request").clone();return e.attr("r_index",r_index),e.find(".request-title").text(t),$("#requests-history").prepend(e),void(r_index+=1)}}async function loadHistoricRequest(e){let t=$(e).attr("r_index"),n=JSON.parse(sessionStorage.getItem("request-"+t)),o=JSON.parse(sessionStorage.getItem("response-"+t));showRequestContent(n),load_content(o)}function check_row(e){return $(e).hasClass("btn-primary")?($(e).removeClass("btn-primary").addClass("btn-danger"),void $(e).closest(".table-row").removeClass("table-row").addClass("table-unrow")):$(e).hasClass("btn-danger")?($(e).removeClass("btn-danger").addClass("btn-primary"),void $(e).closest(".table-unrow").removeClass("table-unrow").addClass("table-row")):void 0}function delete_row(e){$(e).closest(".table-row").remove()}function setup(e){var t=$(e).closest(".table-unrow");t.removeClass("table-unrow").addClass("table-row");let n=$("#helper-elements").find(".checkbox-item").clone(),o=$("#helper-elements").find(".delete-item").clone();$(e).closest("tbody").append(setup_row.clone()),t.find(".table-key").parent().prepend(n),t.find(".table-value").parent().append(o),t.find(".table-key").prop("onkeypress",null),t.find(".table-value").prop("onkeypress",null)}function construct_url(e,t){if(Object.keys(t).length){let n=new URL(e),o=new URLSearchParams(n.search);for(key of Object.keys(t))o.append(key,t[key]);e=new URL(`${n.origin}${n.pathname}?${o}`).href}return e}function makeGetRequest(e,t,n){return e=construct_url(e,t),fetch(req_server+"/get",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({endpoint:e,headers:n})}).then((e=>e.json()))}function loadMimeDB(){return $.getJSON("assets/json/db.json").then((e=>e))}function downloadMimeDB(){return $.getJSON("https://cdn.jsdelivr.net/npm/mime-db@1/db.json").then((e=>e))}$(window).on("load",(async function(){sessionStorage.clear();try{mime_db=await loadMimeDB()}catch(e){mime_db=await downloadMimeDB()}console.assert(null!=mime_db,"mime-db not loaded correctly.")})),$(".method").on("click",(function(){$("#method-button").text(this.text)})),$("#endpoint").on("keyup",(function(e){"Enter"==e.key&&sendRequest()})),$("#send-button").on("click",sendRequest);